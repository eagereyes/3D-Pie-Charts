<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<title>3D Pies!</title>
		 <link href="css/bootstrap.min.css" rel="stylesheet">
		<script src="js/d3.min.js" charset="utf-8"></script>
		<script src="js/numbers.min.js"></script>
		<style>
			.grayslice {
				fill: lightgray;
			}
			
			.body {
				fill: darkgray;
			}
			
			.bluebody {
				fill: #005480;
			}
			
			.blueslice {
				fill: steelblue
			}
			
			#infoPanel, #studyPanel {
				display: none;
			}
			
			#pie {
				display: none;
			}
			
		</style>
	</head>
	<body>
		<div class="row">
			<div class="col-md-8" id="pie">
			</div>
			<div class="col-md-4" id="infoPanel">
				<label>Central Angle: <span id="centralAngleVal"></span>&deg; <input type="range" min="1" max="359" value="30" id="centralAngle" oninput="redraw();"></label><br/>
				<label>View Angle: <span id="viewAngleVal"></span>&deg; <input type="range" min="15" max="90" value="15" id="viewAngle" oninput="redraw();"></label><br/>
				<label>Rotation: <span id="rotationVal"></span>&deg; <input type="range" min="0" max="359" value="220" id="rotation" oninput="redraw();"></label><br />
				<label>Body: <span id="bodyVal"></span><input type="range" min="0" max="50" step="5" value="20" id="bodyHeight" oninput="redraw();"></label><br />
				
				Angle: <span id="angle"></span>&deg;<br/>
				Projected: <span id="distortedAngle"></span>&deg;<br />
				By Arc Length: <span id="angleByArc"></span>&deg;<br />
				By Area: <span id="angleByArea"></span>&deg;<br />
			</div>
		</div>
		<div class="row">
			<div class="col-md-offset-8 col-md-4" id="studyPanel">
				<label>Value: <input type="number" id="percent" onchange="nextStep();" min="1" max="99">%</label>
			</div>
		</div>

		<!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
		<script src="js/jquery-1.12.0.min.js"></script>
		<!-- Include all compiled plugins (below), or include individual files as needed -->
		<script src="js/bootstrap.min.js"></script>
		<script src="threedeepies.js"></script>
		<script src="piestudy.js"></script>
		<script>
			var drawInfo = init();
			
			function rad(degrees) {
				return degrees*Math.PI/180;
			}
			
			function deg(radians) {
				return radians/Math.PI*180;
			}
						
			function redraw() {

				var centralAngle = $('#centralAngle')[0].value;
				$('#centralAngleVal').text(centralAngle);
				
				var viewAngle = $('#viewAngle')[0].value;
				$('#viewAngleVal').text(viewAngle);
				
				var rotation = $('#rotation')[0].value;
				$('#rotationVal').text(rotation);
				
				var bodyHeight = +$('#bodyHeight')[0].value;
				$('#bodyVal').text(bodyHeight);
				
				draw3DPie(drawInfo, rad(centralAngle), rad(viewAngle), rad(rotation), HEIGHT*.4, bodyHeight);
				
				var predictions = predict(rad(centralAngle), rad(viewAngle), rad(rotation));
				
				$('#angle').text(deg(predictions.angle).toFixed(0));
				$('#distortedAngle').text(deg(predictions.angleDistorted).toFixed(0));
				$('#angleByArc').text(deg(predictions.angleByArc).toFixed(0));
				$('#angleByArea').text(deg(predictions.angleByArea).toFixed(0));

			}

			if (window.location.hash === '#panel') {
				$('#infoPanel').show();
				$('#pie').show();

				redraw();
			} else {
				var trials = makeTrials();

				$('#pie').show();
				$('#studyPanel').show();

				startStudy();
			}
			
		</script>
	</body>
</html>